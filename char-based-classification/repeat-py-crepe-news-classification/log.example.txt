Using TensorFlow backend.
Loading data...
Creating vocab...
Build model...
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:15: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(activation="relu", input_shape=(1014, 69), filters=256, kernel_size=7, padding="valid")`
  input_shape=(maxlen, vocab_size))(inputs)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:16: UserWarning: Update your `MaxPooling1D` call to the Keras 2 API: `MaxPooling1D(pool_size=3)`
  conv = MaxPooling1D(pool_length=3)(conv)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:19: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(activation="relu", filters=256, kernel_size=7, padding="valid")`
  border_mode='valid', activation='relu')(conv)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:20: UserWarning: Update your `MaxPooling1D` call to the Keras 2 API: `MaxPooling1D(pool_size=3)`
  conv1 = MaxPooling1D(pool_length=3)(conv1)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:23: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(activation="relu", filters=256, kernel_size=3, padding="valid")`
  border_mode='valid', activation='relu')(conv1)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:26: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(activation="relu", filters=256, kernel_size=3, padding="valid")`
  border_mode='valid', activation='relu')(conv2)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:29: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(activation="relu", filters=256, kernel_size=3, padding="valid")`
  border_mode='valid', activation='relu')(conv3)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:32: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(activation="relu", filters=256, kernel_size=3, padding="valid")`
  border_mode='valid', activation='relu')(conv4)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:33: UserWarning: Update your `MaxPooling1D` call to the Keras 2 API: `MaxPooling1D(pool_size=3)`
  conv5 = MaxPooling1D(pool_length=3)(conv5)
/home/fuyang/Workspace/deep_learning_tutorial/char-based-classification/repeat-py-crepe-news-classification/py_crepe.py:43: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("ou...)`
  model = Model(input=inputs, output=pred)
Fit model...
Epoch: 0
2018-01-21 12:21:04.687438: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-01-21 12:21:04.687457: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-01-21 12:21:04.687462: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-01-21 12:21:04.687466: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-01-21 12:21:04.687470: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-01-21 12:21:04.778389: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:893] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-01-21 12:21:04.778680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.582
pciBusID 0000:01:00.0
Total memory: 10.91GiB
Free memory: 9.82GiB
2018-01-21 12:21:04.778692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2018-01-21 12:21:04.778696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2018-01-21 12:21:04.778701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)
  Step: 100
	Loss: 1.3869460940361023. Accuracy: 0.24287500455975533
  Step: 200
	Loss: 1.3869097977876663. Accuracy: 0.24206250466406345
  Step: 300
	Loss: 1.3868045409520466. Accuracy: 0.24716667105754217
  Step: 400
	Loss: 1.386866714656353. Accuracy: 0.24534375455230475
  Step: 500
	Loss: 1.3868367571830749. Accuracy: 0.2452000048160553
  Step: 600
	Loss: 1.3868258208036424. Accuracy: 0.24593750424683095
  Step: 700
	Loss: 1.3867652140344893. Accuracy: 0.24710714710610254
  Step: 800
	Loss: 1.3867443534731865. Accuracy: 0.24790625428780913
  Step: 900
	Loss: 1.386726446946462. Accuracy: 0.24741667080256674
  Step: 1000
	Loss: 1.3867428033351898. Accuracy: 0.2476625041216612
  Step: 1100
	Loss: 1.3867368430441076. Accuracy: 0.2477954587340355
  Step: 1200
	Loss: 1.386741464237372. Accuracy: 0.24783333746095498
  Step: 1300
	Loss: 1.3867586364195896. Accuracy: 0.2476634656695219
  Step: 1400
	Loss: 1.3867280587979725. Accuracy: 0.24781250414039407
  Step: 1500
	Loss: 1.3867368809382121. Accuracy: 0.2478750040779511
Epoch 0. Loss: 1.3865058785990665. Accuracy: 0.2500000039213582
Epoch time: 0:02:14.331051. Total time: 0:02:15.768086

Epoch: 1
  Step: 100
	Loss: 1.3867604005336762. Accuracy: 0.24750000536441802
  Step: 200
	Loss: 1.3869382172822953. Accuracy: 0.2443125044554472
  Step: 300
	Loss: 1.386799674431483. Accuracy: 0.24650000433127087
  Step: 400
	Loss: 1.3868188726902009. Accuracy: 0.24809375412762166
  Step: 500
	Loss: 1.3868455696105957. Accuracy: 0.24797500410676002
  Step: 600
	Loss: 1.3867588406801223. Accuracy: 0.24916667101283868
  Step: 700
	Loss: 1.3867591088158744. Accuracy: 0.2498214330630643
  Step: 800
	Loss: 1.386711163520813. Accuracy: 0.2500625043548644
  Step: 900
	Loss: 1.386720075474845. Accuracy: 0.25052778219183286
  Step: 1000
	Loss: 1.386729101061821. Accuracy: 0.25100000447034837
  Step: 1100
	Loss: 1.3867116492444818. Accuracy: 0.2511704588749192
  Step: 1200
	Loss: 1.3867042992512386. Accuracy: 0.2510625044256449
  Step: 1300
	Loss: 1.3867061617741219. Accuracy: 0.2507884659216954
  Step: 1400
	Loss: 1.3867020736421858. Accuracy: 0.25050000436604025
  Step: 1500
	Loss: 1.3867273516654968. Accuracy: 0.24998333767056466
Epoch 1. Loss: 1.3865173515520597. Accuracy: 0.25000000360764957
Epoch time: 0:02:12.732765. Total time: 0:04:29.934492

Epoch: 2
  Step: 100
	Loss: 1.3867949950695038. Accuracy: 0.24937500417232514
  Step: 200
	Loss: 1.3867381876707077. Accuracy: 0.24756250455975531
  Step: 300
	Loss: 1.3866606001059214. Accuracy: 0.24829167048136394
  Step: 400
	Loss: 1.3866377121210098. Accuracy: 0.24862500373274088
  Step: 500
	Loss: 1.3866508738994598. Accuracy: 0.24842500388622285
  Step: 600
	Loss: 1.3866346353292465. Accuracy: 0.24864583720763525
  Step: 700
	Loss: 1.3866573318413327. Accuracy: 0.24846428958433014
  Step: 800
	Loss: 1.3866476234793663. Accuracy: 0.24839062897488476
  Step: 900
	Loss: 1.3866483713520898. Accuracy: 0.24858333736658098
  Step: 1000
	Loss: 1.3866720501184464. Accuracy: 0.2484750041514635
  Step: 1100
	Loss: 1.3866372645984997. Accuracy: 0.2490681857818907
  Step: 1200
	Loss: 1.386637414097786. Accuracy: 0.24947917062789202
  Step: 1300
	Loss: 1.3866453404609973. Accuracy: 0.24981731162621426
  Step: 1400
	Loss: 1.3866472124201912. Accuracy: 0.24936607544975622
  Step: 1500
	Loss: 1.3866544639269511. Accuracy: 0.24988333734869958
Epoch 2. Loss: 1.3867080324574521. Accuracy: 0.25000000470562983
Epoch time: 0:02:13.326293. Total time: 0:06:44.692941

Epoch: 3
  Step: 100
	Loss: 1.3866996002197265. Accuracy: 0.25225000485777854
  Step: 200
	Loss: 1.3866383945941925. Accuracy: 0.2525000050663948
  Step: 300
	Loss: 1.3866170875231425. Accuracy: 0.25391667207082114
  Step: 400
	Loss: 1.3865777745842933. Accuracy: 0.2517500051483512
  Step: 500
	Loss: 1.3866255204677582. Accuracy: 0.2488250046670437
  Step: 600
	Loss: 1.3866149979829787. Accuracy: 0.24768750451505184
  Step: 700
	Loss: 1.3866532106058937. Accuracy: 0.2478571474339281
  Step: 800
	Loss: 1.386648210734129. Accuracy: 0.24806250443682074
  Step: 900
	Loss: 1.3866266728772056. Accuracy: 0.2479166710542308
  Step: 1000
	Loss: 1.386646849989891. Accuracy: 0.24771250424534083
  Step: 1100
	Loss: 1.3866298197616231. Accuracy: 0.2476704587448727
  Step: 1200
	Loss: 1.3866279177864393. Accuracy: 0.24741667086879413
  Step: 1300
	Loss: 1.3866505724650162. Accuracy: 0.24759615800128534
  Step: 1400
	Loss: 1.3866476490667887. Accuracy: 0.24755357557641608
  Step: 1500
	Loss: 1.3866598502000174. Accuracy: 0.2476166708121697
Epoch 3. Loss: 1.3864164452803762. Accuracy: 0.25000000407821255
Epoch time: 0:02:13.312792. Total time: 0:08:59.433241

Epoch: 4
  Step: 100
	Loss: 1.3865835213661193. Accuracy: 0.24437500402331352
  Step: 200
	Loss: 1.3865734547376634. Accuracy: 0.2481875041127205
  Step: 300
	Loss: 1.3865787466367085. Accuracy: 0.24741667101780573
  Step: 400
	Loss: 1.386580003798008. Accuracy: 0.2473437543772161
  Step: 500
	Loss: 1.386554674386978. Accuracy: 0.2485500040501356
  Step: 600
	Loss: 1.3865903973579408. Accuracy: 0.24835417088121176
  Step: 700
	Loss: 1.3865902398313794. Accuracy: 0.2480000043021781
  Step: 800
	Loss: 1.3865563108026981. Accuracy: 0.24915625438094138
  Step: 900
	Loss: 1.386582129266527. Accuracy: 0.2489305599199401
  Step: 1000
	Loss: 1.3865759291648865. Accuracy: 0.2494875045567751
  Step: 1100
	Loss: 1.3865865418044003. Accuracy: 0.24970455003055658
  Step: 1200
	Loss: 1.3865876987576484. Accuracy: 0.24940625436604022
  Step: 1300
	Loss: 1.3865876287680405. Accuracy: 0.24970192728134302
  Step: 1400
	Loss: 1.3865669526372637. Accuracy: 0.2498571469954082
  Step: 1500
	Loss: 1.3865660527547201. Accuracy: 0.2500083375225465
Epoch 4. Loss: 1.3870286665464702. Accuracy: 0.25000000266652356
Epoch time: 0:02:13.598289. Total time: 0:11:14.473972

Epoch: 5
  Step: 100
	Loss: 1.3865455389022827. Accuracy: 0.2541250057518482
  Step: 200
	Loss: 1.3865464895963668. Accuracy: 0.25118750497698783
  Step: 300
	Loss: 1.3864608283837636. Accuracy: 0.25191667074958485
  Step: 400
	Loss: 1.3865827697515487. Accuracy: 0.25090625442564485
  Step: 500
	Loss: 1.386606906890869. Accuracy: 0.249475004196167
  Step: 600
	Loss: 1.3865466539065043. Accuracy: 0.249937504529953
  Step: 700
	Loss: 1.3866004988125393. Accuracy: 0.249946433114154
  Step: 800
	Loss: 1.3866098988056184. Accuracy: 0.249328129645437
  Step: 900
	Loss: 1.386583903365665. Accuracy: 0.2498055602527327
  Step: 1000
	Loss: 1.3866428526639938. Accuracy: 0.24937500468641519
  Step: 1100
	Loss: 1.386626253453168. Accuracy: 0.24955682270228863
  Step: 1200
	Loss: 1.3866484265526136. Accuracy: 0.24952083778257172
  Step: 1300
	Loss: 1.3866344122703258. Accuracy: 0.24963461973919318
  Step: 1400
	Loss: 1.386623147215162. Accuracy: 0.2499285757594875
  Step: 1500
	Loss: 1.3866504867076874. Accuracy: 0.2494833375563224
Epoch 5. Loss: 1.3868379592895508. Accuracy: 0.25000000533304717
Epoch time: 0:02:13.674706. Total time: 0:13:29.573861

Epoch: 6
  Step: 100
	Loss: 1.3867221665382385. Accuracy: 0.24787500388920308
  Step: 200
	Loss: 1.386605011820793. Accuracy: 0.24868750344961882
  Step: 300
	Loss: 1.386599821249644. Accuracy: 0.24866667039692403
  Step: 400
	Loss: 1.3866211247444153. Accuracy: 0.24784375382587315
  Step: 500
	Loss: 1.3866138277053832. Accuracy: 0.24717500354349614
  Step: 600
	Loss: 1.386598170598348. Accuracy: 0.24737500358372927
  Step: 700
	Loss: 1.3866130581923894. Accuracy: 0.24821428958858763
  Step: 800
	Loss: 1.3866098839044572. Accuracy: 0.2489218788407743
  Step: 900
	Loss: 1.3866269558005864. Accuracy: 0.24875000392397245
  Step: 1000
	Loss: 1.386612468123436. Accuracy: 0.249275003939867
  Step: 1100
	Loss: 1.386602361310612. Accuracy: 0.24903409482403235
  Step: 1200
	Loss: 1.3866224641601244. Accuracy: 0.24872917057325442
  Step: 1300
	Loss: 1.386621216718967. Accuracy: 0.24873077305463645
  Step: 1400
	Loss: 1.3866227578265327. Accuracy: 0.2483214324925627
  Step: 1500
	Loss: 1.38661988957723. Accuracy: 0.2481083372036616
Epoch 6. Loss: 1.3864766020523875. Accuracy: 0.25000000360764957
Epoch time: 0:02:13.631336. Total time: 0:15:44.669215

Epoch: 7
  Step: 100
	Loss: 1.386573051214218. Accuracy: 0.2537500035762787
  Step: 200
	Loss: 1.3865647196769715. Accuracy: 0.25412500463426113
  Step: 300
	Loss: 1.386526581843694. Accuracy: 0.2538333377490441
  Step: 400
	Loss: 1.386487386226654. Accuracy: 0.25325000455603003
  Step: 500
	Loss: 1.3865188100337982. Accuracy: 0.25292500476539137
  Step: 600
	Loss: 1.3865118539333343. Accuracy: 0.25183333780616524
  Step: 700
	Loss: 1.3865379272188458. Accuracy: 0.25137500446821964
  Step: 800
	Loss: 1.386556077450514. Accuracy: 0.25132812972180546
  Step: 900
	Loss: 1.3865453045898013. Accuracy: 0.251555560156703
  Step: 1000
	Loss: 1.3865628371238707. Accuracy: 0.25035000454634426
  Step: 1100
	Loss: 1.3865558541904797. Accuracy: 0.24946591354906558
  Step: 1200
	Loss: 1.3865715175867082. Accuracy: 0.2493645878446599
  Step: 1300
	Loss: 1.3865669237650358. Accuracy: 0.2497788506345107
  Step: 1400
	Loss: 1.3865694625888552. Accuracy: 0.24988393304071257
  Step: 1500
	Loss: 1.3865569553375243. Accuracy: 0.2498583376854658
Epoch 7. Loss: 1.3866404960030003. Accuracy: 0.25000000407821255
Epoch time: 0:02:14.056279. Total time: 0:18:00.153810

Epoch: 8
  Step: 100
	Loss: 1.3863652563095092. Accuracy: 0.24962500624358655
  Step: 200
	Loss: 1.3865089678764344. Accuracy: 0.2491875049099326
  Step: 300
	Loss: 1.386510471900304. Accuracy: 0.2513750041772922
  Step: 400
	Loss: 1.3864919498562813. Accuracy: 0.2513125047646463
  Step: 500
	Loss: 1.3864449939727783. Accuracy: 0.251775004401803
  Step: 600
	Loss: 1.3865037089586258. Accuracy: 0.25072917105009157
  Step: 700
	Loss: 1.3864964003222329. Accuracy: 0.25042857554342063
  Step: 800
	Loss: 1.3865290850400924. Accuracy: 0.24990625408478082
  Step: 900
	Loss: 1.3865195288923051. Accuracy: 0.2496944486349821
  Step: 1000
	Loss: 1.3865458693504333. Accuracy: 0.24937500428408385
  Step: 1100
	Loss: 1.3865579648451372. Accuracy: 0.2486931860108267
  Step: 1200
	Loss: 1.3865582609176637. Accuracy: 0.24841667079056304
  Step: 1300
	Loss: 1.3865635251998902. Accuracy: 0.24810577326669142
  Step: 1400
	Loss: 1.3865674741779055. Accuracy: 0.24808036105441195
  Step: 1500
	Loss: 1.3865363663037618. Accuracy: 0.24825833723445734
Epoch 8. Loss: 1.3868885567313747. Accuracy: 0.25000000407821255
Epoch time: 0:02:13.943858. Total time: 0:20:15.530202

Epoch: 9
  Step: 100
	Loss: 1.3867686092853546. Accuracy: 0.25175000324845315
  Step: 200
	Loss: 1.3866058760881423. Accuracy: 0.2551250038295984
  Step: 300
	Loss: 1.3865695091088612. Accuracy: 0.2547500043610732
  Step: 400
	Loss: 1.3866201648116112. Accuracy: 0.25200000416487456
  Step: 500
	Loss: 1.3866425142288208. Accuracy: 0.2514500042498112
  Step: 600
	Loss: 1.3866052701075873. Accuracy: 0.25095833765963715
  Step: 700
	Loss: 1.3866213408538273. Accuracy: 0.25137500454272543
  Step: 800
	Loss: 1.3866093274950981. Accuracy: 0.2505625043809414
  Step: 900
	Loss: 1.3866314143604703. Accuracy: 0.2503194489578406
  Step: 1000
	Loss: 1.3866171572208406. Accuracy: 0.25012500448524955
  Step: 1100
	Loss: 1.3866215273466977. Accuracy: 0.25011364083398474
  Step: 1200
	Loss: 1.3866071598728498. Accuracy: 0.2504895879328251
  Step: 1300
	Loss: 1.3866227711164034. Accuracy: 0.24962500463311488
  Step: 1400
	Loss: 1.386618289266314. Accuracy: 0.2496428616877113
  Step: 1500
	Loss: 1.38661673839887. Accuracy: 0.2500000044802825
Epoch 9. Loss: 1.3864263885899595. Accuracy: 0.25000000619574597
Epoch time: 0:02:13.828373. Total time: 0:22:30.799764
